# Story 2.1: RSVP UI Component & Interactions

Status: complete

## Story

As a Guest,
I want to easily tap to confirm attendance for each family member,
so that my response is saved instantly without extra steps.

## Acceptance Criteria

1. **Given** The user sees the RSVP section
2. **When** They toggle "Yes" or "No" for a family member
3. **Then** The selection is immediately saved to the server (auto-save)
4. **And** The UI shows visual confirmation (confetti, checkmark) without needing a submit button

## Tasks / Subtasks

- [x] Create RSVPSection Component (`src/components/rsvp/RSVPSection.tsx`) (AC: 1)
  - [x] Accept `guests: Guest[]` and `householdName: string` as props
  - [x] Display section header: "ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ ÑƒÑ‡Ğ°ÑÑ‚Ğ¸Ñ" with gold accents
  - [x] Render a `GuestRSVPCard` for each guest
  - [x] Display optimistic UI state while server updates
- [x] Create GuestRSVPCard Component (`src/components/rsvp/GuestRSVPCard.tsx`) (AC: 2, 3, 4)
  - [x] Display guest name prominently
  - [x] Render two emoji buttons: ğŸ‘ (Ğ”Ğ°) and ğŸ‘ (ĞĞµÑ‚)
  - [x] Implement toggle behavior: clicking one deselects the other
  - [x] **Auto-save**: Call `updateGuestRsvp` server action on each tap
  - [x] Show loading state during save (subtle spinner on button)
  - [x] Visual feedback: selected button gets `blush` background, scale animation
  - [x] Confetti burst when selecting "Yes" for the first time
  - [x] Handle `null` initial state (no selection yet)
- [x] Implement Auto-Save Logic (AC: 3, 4)
  - [x] Call `updateGuestRsvp(guestId, isAttending)` on each tap
  - [x] Use `useTransition` for pending state
  - [x] Optimistic UI: update local state immediately, revert on error
  - [x] Show success confirmation after all household members respond
- [x] Integrate into Landing Page (`src/app/(public)/page.tsx`)
  - [x] Add RSVPSection after content sections
  - [x] Pass guest data from server component

## UX Specifications

### Visual Design

| Token | Value | Usage |
|-------|-------|-------|
| `blush` | `#F8B4C0` | Selected "Yes" button, primary accent |
| `gold` | `#D4AF76` | Section borders, decorative elements |
| `cream` | `#FFF8F0` | Section background |
| `sage` | `#B8C9A8` | Success confirmation |
| `charcoal` | `#3D3D3D` | Primary text |
| `muted` | `#757575` | Unselected button state |

### Typography

- **Section Header**: Cormorant Garamond, 1.75rem (28px)
- **Guest Names**: Inter, 1.25rem (20px), semi-bold
- **Button Labels**: Inter, 1rem (16px)
- **Instructions**: Inter, 0.875rem (14px), muted

### Component Specs

#### RSVPSection Container
| Aspect | Requirement |
|--------|-------------|
| **Style** | Full-width section, `cream` background |
| **Padding** | 48px vertical (6 units), 24px horizontal |
| **Border** | Top border with `gold` accent |
| **Header** | Centered, romantic font |

#### GuestRSVPCard
| Aspect | Requirement |
|--------|-------------|
| **Layout** | Horizontal: Name on left, buttons on right |
| **Spacing** | 16px gap between cards |
| **Buttons** | 60px Ã— 60px minimum (larger than 44px requirement) |
| **States** | Default (outlined), Selected (filled), Hover (scale) |
| **Animation** | `scale(1.1)` on selection, `transition-all duration-200` |

#### Confirmation Banner (shows after all selections made)
| Aspect | Requirement |
|--------|-------------|
| **Style** | Success banner, `sage` background |
| **Content** | "âœ“ Ğ–Ğ´Ñ‘Ğ¼ Ğ²Ğ°Ñ!" or "Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‚" |
| **Animation** | Fade in when all household members have responded |

### Rough Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚           âœ¨ ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ ÑƒÑ‡Ğ°ÑÑ‚Ğ¸Ñ                      â”‚
â”‚         (ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Ğ˜Ğ²Ğ°Ğ½ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²                    [ğŸ‘] [ğŸ‘]        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ĞœĞ°Ñ€Ğ¸Ñ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²Ğ°                  [ğŸ‘] [ğŸ‘]        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ĞĞ»ĞµĞºÑĞµĞ¹ ĞŸĞµÑ‚Ñ€Ğ¾Ğ² (Ñ€ĞµĞ±Ñ‘Ğ½Ğ¾Ğº)       [ğŸ‘] [ğŸ‘]        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚   âœ“ Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾! Ğ–Ğ´Ñ‘Ğ¼ Ğ²Ğ°Ñ Ğ½Ğ° ÑĞ²Ğ°Ğ´ÑŒĞ±Ğµ!           â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚              â†‘ appears after all responses              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Interaction States

| State | Description | Visual |
|-------|-------------|--------|
| **Initial** | No selections made | Both buttons outlined/muted |
| **Saving** | Tap in progress | Subtle spinner on tapped button |
| **Saved** | Selection confirmed | Button filled, brief checkmark flash |
| **Partial** | Some guests responded | Show progress "2 Ğ¸Ğ· 3" |
| **Complete** | All guests responded | Success banner appears |
| **Error** | Save failed | Shake animation, retry tap |

### Emotional Design Requirements

- **Celebration, Not Obligation**: Buttons should feel like "joining the party" not "filling a form"
- **Immediate Feedback**: Visual confirmation on each tap
- **Low Pressure**: Easy to change selections before submitting
- **Family Unity**: Household responses feel cohesive

### Accessibility

| Requirement | Implementation |
|-------------|----------------|
| Color contrast | 4.5:1 minimum (WCAG AA) |
| Touch targets | 60px Ã— 60px buttons (exceeds 44px) |
| Focus states | Visible focus rings, keyboard navigation |
| ARIA | `role="radiogroup"` for Yes/No selection per guest |
| Screen readers | Button labels "Ğ˜Ğ²Ğ°Ğ½ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²: Ğ”Ğ°" / "Ğ˜Ğ²Ğ°Ğ½ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²: ĞĞµÑ‚" |

### Responsive Behavior

| Breakpoint | Behavior |
|------------|----------|
| Mobile (<640px) | Stacked cards, full-width, larger buttons |
| Desktop (>1024px) | Max-width 720px, centered container |

## Dev Notes

### Architecture Compliance

- **Client Component**: RSVPSection needs `"use client"` for local state management
- **Server Component Parent**: Page.tsx remains a Server Component fetching guest data
- **No Forms**: Use button clicks, NOT form inputs (per UX anti-patterns)
- **State Pattern**: Use `useState` with `Map<guestId, boolean | null>` for selections

### File Structure

| File | Purpose |
|------|---------|
| `src/components/rsvp/RSVPSection.tsx` | Main RSVP container (Client Component) |
| `src/components/rsvp/GuestRSVPCard.tsx` | Individual guest card |
| `src/components/rsvp/types.ts` | Shared types for RSVP components |

### Data Flow

```
page.tsx (Server)
    â†“ fetches guests from DB
    â†“ passes as props
RSVPSection (Client)
    â†“ displays all guests
    â†“ manages optimistic state
GuestRSVPCard (Client)
    â†“ calls updateGuestRsvp(guestId, isAttending) on tap
    â†“ shows loading/success state
```

### TypeScript Interfaces

```typescript
// src/components/rsvp/types.ts
export interface GuestForRSVP {
  _id: string;
  guestName: string;
  isAttending: boolean | null;
}

export interface RSVPSectionProps {
  guests: GuestForRSVP[];
  householdName: string;
  householdId: string;
}

export interface GuestRSVPCardProps {
  guest: GuestForRSVP;
  onUpdate: (guestId: string, isAttending: boolean) => Promise<void>;
}
```

### Previous Story Intelligence

From Story 1.4 (Core Content Sections):
- Components go in `/src/components/layout/` or feature folders like `/src/components/rsvp/`
- Use `"use client"` directive for interactive components
- Follow the "Romantic Block Story" theme with Tailwind utilities
- Respect `prefers-reduced-motion` for animations

### Project Structure Notes

- Create new `/src/components/rsvp/` directory for RSVP components
- Aligns with architecture pattern: `/components/[feature]/`
- No barrel exports (per project-context.md rules)

### References

- [Architecture: Frontend Architecture](file:///e:/WebDev/wedding/_bmad-output/planning-artifacts/architecture.md#Frontend-Architecture)
- [UX Design: RSVP Component Strategy](file:///e:/WebDev/wedding/_bmad-output/planning-artifacts/ux-design-specification.md#Component-Strategy)
- [Epics: Story 2.1](file:///e:/WebDev/wedding/_bmad-output/planning-artifacts/epics.md#Story-2.1-RSVP-UI-Component)
- [Guest Model](file:///e:/WebDev/wedding/src/models/Guest.ts)

## Dev Agent Record

### Agent Model Used

Antigravity (gemini-2.5-pro)

### Debug Log References

N/A

### Completion Notes List

- Created RSVP component structure under `src/components/rsvp/`
- Implemented optimistic UI with automatic revert on error
- Added confetti animation on first "Yes" selection
- Used `useTransition` for non-blocking server action calls
- Added `sage` and `muted` colors to Tailwind theme
- Added `fadeIn` animation for completion banner

### File List

- `src/components/rsvp/types.ts` (NEW)
- `src/components/rsvp/GuestRSVPCard.tsx` (NEW)
- `src/components/rsvp/RSVPSection.tsx` (NEW)
- `src/app/(public)/page.tsx` (MODIFIED)
- `src/app/globals.css` (MODIFIED)
