# Story 2.5: Guest Wishes & Messages

**Parent Epic:** [Epic 2: RSVP & Household Management](epics.md)

## User Story
As a Guest,
I want to leave a message or wish for the couple,
So that I can personalize my RSVP with warm words.

## Context
Guests often want to share excitement or congratulations along with their RSVP. Currently, there is no free-text field for this. Adding this feature allows guests to express themselves and gives the couple a collection of warm wishes to read.

## Acceptance Criteria

### 1. Message Input Field
- **Given** The user is on the Questionnaire step of the RSVP flow.
- **When** They scroll to the end of the form (before the "Finish" button).
- **Then** They see a "Wishes / Message" section.
- **And** A text area is provided for entering a message.
- **And** The field is **optional** (guests can skip it).
- **And** The input supports emojis and standard text.
- **And** There is a reasonable character limit (e.g., 1000 characters).

### 2. "From Whole Family" Option
- **Given** The user is a **Head of Household** (HoH).
- **When** They interact with the message section.
- **Then** They see a checkbox option: "Sign for the whole family" (or "От всей семьи").
- **And** By default, this might be unchecked.
- **When** Checked, it visually indicates that the message will be attributed to the entire household.

### 3. Data Persistence
- **When** The user submits the questionnaire.
- **Then** The message is saved to the database.
- **And** The "From Whole Family" status is preserved (or inferred).

## Technical Specifications

### Data Model
**File:** `src/models/GuestQuestionnaire.ts`
- Add `message`: `String` (optional).
- Add `isFamilyMessage`: `Boolean` (optional, default false) - distinct flag to explicitly track if the user checked "From whole family".

### Server & API
**File:** `src/actions/questionnaire.actions.ts`
- Update the input Zod schema (if applicable) to include `message` and `isFamilyMessage`.
- Ensure the `updateGuestQuestionnaire` (or equivalent) function saves these new fields.

### UI Components
**File:** `src/components/rsvp/QuestionnaireForm.tsx` (Confirm actual path)
- Add `Textarea` component for the message.
- Add `Checkbox` for "From whole family" (conditionally rendered: `guest.isHeadOfHousehold`).

## Design & Copy
- **Label:** "Ваши пожелания" (Your Wishes).
- **Placeholder:** "Напишите пару теплых слов..." (Write a few warm words...).
- **Checkbox Label:** "От всей семьи" (From the whole family).
- **Icon:** Use a message heart icon (e.g., `MessageCircleHeart` or similar) near the header.

## UX & Design Guidelines
### 1. Emotional Design (Mood & Feel)
- **Visual Style:** Soft, inviting text area. Consider `rounded-xl` and a subtle glow on focus (gold/theme color) instead of a harsh default border.
- **Micro-interactions:** 
  - Input should `auto-grow` to accommodate longer messages without inner scrollbars if possible.
  - "From Whole Family" checkbox should appear *below* the text area.

### 2. Layout & Context
- **Placement:** This section goes at the very end of the form, just before the "Finish" button.
- **HoH Logic:** 
  - The "From Whole Family" checkbox is **strictly** for the Head of Household.
  - If checked, the UI might subtly indicate unification (optional animation or label change).

### 3. Mobile Considerations
- Ensure the text area is focusable without the keyboard covering it.
- Enough padding clearly separates it from the "Finish" button so it's not accidentally skipped or submitted prematurely.
