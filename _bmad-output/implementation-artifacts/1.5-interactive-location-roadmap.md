# Story 1.5: Scroll-Driven Interactive Map

Status: review

## Story

As a Guest,
I want to see a simplified map of Azov that moves through wedding venues as I scroll,
So that I can visually explore the wedding day journey in an engaging, interactive way.

## Acceptance Criteria

1. **Given** The user is on the landing page
2. **When** They scroll to the Map section
3. **Then** The map section becomes **sticky** and the map is centered on the first venue (Ð—ÐÐ“Ð¡)
4. **And** As the user **continues scrolling**, the map smoothly pans to the next venue:
   - Scroll position 0-33%: **Ð—ÐÐ“Ð¡** (Ð Ð¾ÑÐ¿Ð¸ÑÑŒ) â€” Map centered here, info card visible
   - Scroll position 33-66%: **Ð¥Ñ€Ð°Ð¼** (Ð’ÐµÐ½Ñ‡Ð°Ð½Ð¸Ðµ) â€” Map pans to church, new info card
   - Scroll position 66-100%: **Ð ÐµÑÑ‚Ð¾Ñ€Ð°Ð½ Â«Ð¨ÐµÑ€ Ð¥Ð¾Ñ„Â»** (Ð‘Ð°Ð½ÐºÐµÑ‚) â€” Map pans to restaurant
5. **And** Each venue displays an **info card** with:
   - Photo of the location
   - Name and time
   - Address
   - "ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ" button (external Yandex/Google Maps link)
6. **And** The map is **simplified** â€” minimal labels, clean design, no clutter
7. **And** **Distance indicators** appear between venues when transitioning
8. **And** The component works smoothly on mobile and desktop

## Venue Data

| # | Name | Address | Time | Coordinates | Photo | Distance to Next |
|---|------|---------|------|-------------|-------|------------------|
| 1 | **Ð—ÐÐ“Ð¡ Ð³. ÐÐ·Ð¾Ð²** | ÑƒÐ». ÐœÐ¸Ñ€Ð°, 19/31, ÐÐ·Ð¾Ð² | 13:00 | 47.107977, 39.419287 | `/images/venues/zags.jpg` | ðŸš¶ ~5 Ð¼Ð¸Ð½ Ð¿ÐµÑˆÐºÐ¾Ð¼ |
| 2 | **Ð¥Ñ€Ð°Ð¼ ÐÐ·Ð¾Ð²ÑÐºÐ¾Ð¹ Ð¸ÐºÐ¾Ð½Ñ‹ Ð‘Ð¾Ð¶Ð¸ÐµÐ¹ ÐœÐ°Ñ‚ÐµÑ€Ð¸** | ÑƒÐ». ÐœÐ°ÐºÐ°Ñ€Ð¾Ð²ÑÐºÐ¾Ð³Ð¾, 25Ð‘, ÐÐ·Ð¾Ð² | 14:00 | 47.1069, 39.4125 | `/images/venues/church.jpg` | ðŸš— ~15 Ð¼Ð¸Ð½ |
| 3 | **Ð ÐµÑÑ‚Ð¾Ñ€Ð°Ð½ Â«Ð¨ÐµÑ€ Ð¥Ð¾Ñ„Â»** | ÐŸÐ»ÑÐ¶Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐ·Ð´, 18, ÐÐ·Ð¾Ð² | 16:00 | 47.111626, 39.441170 | `/images/venues/restaurant.jpeg` | â€” |

### External Map Links

- **Ð—ÐÐ“Ð¡**: `https://yandex.ru/maps/?pt=39.419287,47.107977&z=17&l=map`
- **Ð¥Ñ€Ð°Ð¼**: `https://yandex.ru/maps/?pt=39.4125,47.1069&z=17&l=map`
- **Ð¨ÐµÑ€ Ð¥Ð¾Ñ„**: `https://yandex.ru/maps/?pt=39.441170,47.111626&z=17&l=map`

## Tasks / Subtasks

### Map Component Architecture
- [x] Create `ScrollDrivenMap` component (`src/components/layout/ScrollDrivenMap.tsx`)
  - [x] Use `position: sticky` for map container
  - [x] Track scroll progress within the section (0-100%)
  - [x] Calculate active venue based on scroll thresholds

### Map Rendering Options
- [ ] **Option A: SVG Map** (Deprecated)
  - [ ] Create simplified SVG of Azov with 3 markers
  - [ ] Animate viewBox or transform based on scroll
- [x] **Option B: Leaflet (Real Map)** (Implemented)
  - [x] Use minimal tile style (CartoDB Positron No Labels)
  - [x] Animate `flyTo()` on scroll thresholds
  - [x] Custom Gold styling via CSS filters

### Scroll-Linked Animation
- [x] Implement `Intersection Observer` or `scroll` event listener
- [x] Calculate scroll progress: `(scrollY - sectionTop) / sectionHeight`
- [x] Map scroll progress to venue index (0, 1, 2)
- [x] Smooth transitions between venues (easing)

### Venue Info Cards
- [x] Create `VenueInfoCard` component
  - [x] Display: photo, name, time, address
  - [x] "ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ" button â†’ Yandex Maps link
  - [x] Animate card transitions (fade/slide)

### Distance Indicators
- [x] Show distance badge during transitions:
  - [x] Ð—ÐÐ“Ð¡ â†’ Ð¥Ñ€Ð°Ð¼: ðŸš¶ "~5 Ð¼Ð¸Ð½ Ð¿ÐµÑˆÐºÐ¾Ð¼" (sage badge)
  - [x] Ð¥Ñ€Ð°Ð¼ â†’ Ð ÐµÑÑ‚Ð¾Ñ€Ð°Ð½: ðŸš— "~15 Ð¼Ð¸Ð½" (gray badge)

### Styling
- [x] Match "Romantic Block Story" theme
- [x] Gold accent for active marker, blush for map path
- [x] Cream tint for map background
- [x] Soft shadows on info cards

### Integration
- [x] Replace existing `LocationSection` component
- [x] Add photos for all 3 venues
- [x] Ensure accessibility (ARIA live regions for venue changes)
- [x] Test on mobile (touch scroll), tablet, desktop

## UX Specifications

### Scroll Behavior Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SCROLL PROGRESS                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  0%           33%           66%           100%          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚  â”‚   Ð—ÐÐ“Ð¡      â”‚   Ð¥Ð ÐÐœ      â”‚  Ð¨Ð•Ð  Ð¥ÐžÐ¤   â”‚            â”‚
â”‚  â”‚  (active)   â”‚  (active)   â”‚  (active)  â”‚            â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                                               â”‚      â”‚
â”‚  â”‚        [STICKY MAP CONTAINER]                 â”‚      â”‚
â”‚  â”‚                                               â”‚      â”‚
â”‚  â”‚    â—â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—                  â”‚      â”‚
â”‚  â”‚   Ð—ÐÐ“Ð¡   Ð¥Ñ€Ð°Ð¼          Ð¨ÐµÑ€ Ð¥Ð¾Ñ„               â”‚      â”‚
â”‚  â”‚                                               â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚      â”‚
â”‚  â”‚  â”‚ ðŸ“¸ [Photo]              â”‚                  â”‚      â”‚
â”‚  â”‚  â”‚ â›ª Ð¥Ñ€Ð°Ð¼ ÐÐ·Ð¾Ð²ÑÐºÐ¾Ð¹ Ð¸ÐºÐ¾Ð½Ñ‹  â”‚ â† Active card   â”‚      â”‚
â”‚  â”‚  â”‚ ðŸ• 14:00                â”‚                  â”‚      â”‚
â”‚  â”‚  â”‚ ï¿½ ÑƒÐ». ÐœÐ°ÐºÐ°Ñ€Ð¾Ð²ÑÐºÐ¾Ð³Ð¾, 25Ð‘â”‚                  â”‚      â”‚
â”‚  â”‚  â”‚ [ðŸ—ºï¸ ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ] â”‚                  â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚      â”‚
â”‚  â”‚                                               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                         â”‚
â”‚  [Continue scrolling to see next venue...]              â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Visual Design Tokens

| Token | Value | Usage |
|-------|-------|-------|
| `blush` | `#F8B4C0` | Active marker, hover states |
| `gold` | `#D4AF76` | Path lines, connecting dots |
| `cream` | `#FFF8F0` | Card backgrounds, map tint |
| `sage` | `#B8C9A8` | Walking distance badge |
| `charcoal` | `#3D3D3D` | Inactive markers, text |
| `muted` | `#757575` | Car distance badge |

### Typography

- **Venue Name**: Cormorant Garamond, 1.25rem (20px), semi-bold
- **Time**: Inter, 1rem (16px), bold, gold color
- **Address**: Inter, 0.875rem (14px), muted gray
- **Distance Badge**: Inter, 0.75rem (12px), badge background

### Map Style Requirements

> [!IMPORTANT]
> ÐšÐ°Ñ€Ñ‚Ð° Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ **ÑƒÐ¿Ñ€Ð¾Ñ‰Ñ‘Ð½Ð½Ð¾Ð¹** â€” Ð±ÐµÐ· Ð»Ð¸ÑˆÐ½Ð¸Ñ… Ñ‚Ð¾Ñ‡ÐµÐº Ð¸ Ð¾Ð±Ð¾Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹.

**For SVG approach:**
- Custom illustrated map with only essential streets
- 3 venue markers with connecting path
- Romantic, hand-drawn aesthetic

**For Mapbox/Leaflet approach:**
- Use minimal style (light/monochrome)
- Hide all POIs except our venues
- Custom marker icons (gold/blush colors)

### Interaction Design

| Interaction | Behavior |
|-------------|----------|
| **Scroll down** | Map pans to next venue, info card transitions |
| **Scroll up** | Map pans to previous venue |
| **Tap marker** | Jumps to that venue (optional) |
| **"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ" button** | Opens Yandex Maps in new tab |

### Accessibility

| Requirement | Implementation |
|-------------|----------------|
| ARIA | `aria-live="polite"` on info card container |
| Keyboard | Tab to map, arrow keys to navigate venues |
| Screen reader | Announce venue name on change |
| Motion | `prefers-reduced-motion`: instant transitions |
| Focus | Visible focus on buttons and markers |

### Responsive Behavior

| Breakpoint | Layout |
|------------|--------|
| Mobile (<640px) | Full-width, portrait map + card below |
| Tablet (640-1024px) | Map + card side by side |
| Desktop (>1024px) | Centered, max-width 900px, elegant spacing |

## Technical Notes

### Scroll-Linked Animation Approaches

1. **CSS `scroll-timeline`** (modern browsers)
   - Native CSS solution, very smooth
   - Limited browser support (check caniuse)

2. **JavaScript `IntersectionObserver` + `scroll` events**
   - Wider browser support
   - Calculate progress manually
   - Use `requestAnimationFrame` for smooth updates

3. **Libraries: Framer Motion, GSAP ScrollTrigger**
   - Battle-tested scroll animations
   - May add bundle size

> [!TIP]
> Start with JS approach for maximum compatibility. Can optimize later.

### Sticky Container Implementation

```tsx
// Pseudo-code
<section className="relative h-[300vh]"> {/* Tall section for scroll space */}
  <div className="sticky top-0 h-screen"> {/* Sticky map */}
    <ScrollDrivenMap scrollProgress={progress} />
    <VenueInfoCard venue={activeVenue} />
  </div>
</section>
```

## Dev Notes

- **Photos**: User confirmed photos are available â€” need to add them to `/public/images/venues/`
- **Map Approach**: Start with SVG for cleanest look. Can try Mapbox later if interactive zoom needed.
- **Bundle size**: Prefer native JS over heavy libraries
- **Testing**: Test scroll on both mouse wheel and touch devices

### References

- [Story 1.4: Core Content Sections](file:///e:/WebDev/wedding/_bmad-output/implementation-artifacts/1.4-core-content-sections.md)
- [UX Design Specification](file:///e:/WebDev/wedding/_bmad-output/planning-artifacts/ux-design-specification.md)

## Dev Agent Record

### Agent Model Used

_(to be filled after implementation)_

### Completion Notes List

- Story enhances Epic 1 with scroll-driven map navigation of wedding venues.
